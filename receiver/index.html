<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AirDash</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';"/>
</head>
<body>
<h1>AirDash</h1>
<p>Easiest file transfer from Android to Computer</p>
<p>Listening for files...</p>

<script src="../node_modules/peerjs/dist/peerjs.js"></script>
<script>
  const fs = require('fs')
  const peer = new peerjs.Peer('simonbengtsson-airdash')
  peer.on('connection', function(conn) {
    conn.on('data', function(message) {
      console.log(message)
      storeMessage(message)
    })
  })
  fs.unlinkSync(messageFilePath())

  function messageFilePath() {
    const path = require('path')
    const os = require('os')

    const desktopPath = path.join(os.homedir(), 'Desktop')
    return path.join(desktopPath, 'message.txt')
  }

  function storeMessage(message) {
    fs.writeFileSync(messageFilePath(), message)
  }
</script>
</body>
</html>